<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Scan - Soda SQL Documentation</title> <link rel="shortcut icon" href="/soda-sql/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/soda-sql/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/soda-sql/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/soda-sql/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Scan | Soda SQL Documentation</title> <meta name="generator" content="Jekyll v4.2.0" /> <meta property="og:title" content="Scan" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="This is the documentation site for Soda testing and monitoring for SQL accessible data." /> <meta property="og:description" content="This is the documentation site for Soda testing and monitoring for SQL accessible data." /> <link rel="canonical" href="/soda-sql/documentation/scan.html" /> <meta property="og:url" content="/soda-sql/documentation/scan.html" /> <meta property="og:site_name" content="Soda SQL Documentation" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Scan" /> <script type="application/ld+json"> {"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/soda-sql/assets/images/soda-logo.svg"}},"description":"This is the documentation site for Soda testing and monitoring for SQL accessible data.","url":"/soda-sql/documentation/scan.html","@type":"WebPage","headline":"Scan","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/soda-sql/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/soda-sql/" class="nav-list-link">Getting Started</a><ul class="nav-list "><li class="nav-list-item "><a href="/soda-sql/getting-started/installation.html" class="nav-list-link">Installation</a></li><li class="nav-list-item "><a href="/soda-sql/getting-started/5_min_tutorial.html" class="nav-list-link">5 min tutorial</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/soda-sql/documentation/" class="nav-list-link">Documentation</a><ul class="nav-list "><li class="nav-list-item "><a href="/soda-sql/documentation/concepts.html" class="nav-list-link">Concepts</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/cli.html" class="nav-list-link">CLI</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/warehouse.html" class="nav-list-link">Warehouse</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/warehouse_types.html" class="nav-list-link">Warehouse types</a></li><li class="nav-list-item active"><a href="/soda-sql/documentation/scan.html" class="nav-list-link active">Scan</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/tests.html" class="nav-list-link">Tests</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/sql_metrics.html" class="nav-list-link">SQL metrics</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/time_partitioning.html" class="nav-list-link">Time partitioning</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/orchestrate_scans.html" class="nav-list-link">Orchestrate scans</a></li><li class="nav-list-item "><a href="/soda-sql/documentation/roadmap.html" class="nav-list-link">Roadmap and release notes</a></li></ul></li><li class="nav-list-item"><a href="/soda-sql/community.html" class="nav-list-link">Community</a></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Soda SQL Documentation" aria-label="Search Soda SQL Documentation" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="//github.com/sodadata/soda-sql" class="site-button" > Soda SQL on GitHub </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/soda-sql/documentation/">Documentation</a></li> <li class="breadcrumb-nav-list-item"><span>Scan</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="scan"> <a href="#scan" class="anchor-heading" aria-labelledby="scan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scan </h1> <p>This section explains what a scan does, how it works and how to use <code class="language-plaintext highlighter-rouge">scan.yml</code> files to configure them.</p> <p>For running scans, see either <a href="/soda-sql/documentation/cli.html">the CLI</a> or <a href="/soda-sql/documentation/orchestrate_scans.html">Orchestrate scans</a>.</p> <h2 id="anatomy-of-a-scan"> <a href="#anatomy-of-a-scan" class="anchor-heading" aria-labelledby="anatomy-of-a-scan"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Anatomy of a scan </h2> <p>A scan is performed on a table and does the following:</p> <ul> <li>Fetch the column metadata of the table (column name, type and nullable)</li> <li>Single aggregation query that computes aggregate metrics for multiple columns like e.g. missing, min, max etc</li> <li>For each column <ul> <li>One query for distinct_count, unique_count and valid_count</li> <li>One query for mins (list of smallest values)</li> <li>One query for maxs (list of greatest values)</li> <li>One query for frequent values</li> <li>One query for histograms</li> </ul> </li> </ul> <blockquote> <p>Note on performance: we have tuned most column queries by using the same Column Table Expression (CTE). The goal is to allow some databases, like eg Snowflake, to be able to cache the results, but we didn’t see actual proof of this yet. If you have knowledge on this, <a href="/soda-sql/community.html">drop us a line in one of the channels</a>.</p> </blockquote> <h2 id="top-level-scanyml-keys"> <a href="#top-level-scanyml-keys" class="anchor-heading" aria-labelledby="top-level-scanyml-keys"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Top level scan.yml keys </h2> <p>In a <code class="language-plaintext highlighter-rouge">scan.yml</code> file, you configure which metrics should be computed and which tests should be checked.</p> <p>Top level configuration keys:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Key</th> <th>Description</th> <th>Required</th> </tr> </thead> <tbody> <tr> <td>table_name</td> <td>The table name.</td> <td>Required</td> </tr> <tr> <td>metrics</td> <td>The list of metrics to compute. Column metrics specified here will be computed on each column.</td> <td>Optional</td> </tr> <tr> <td>columns</td> <td>Optionally add metrics and configurations for specific columns</td> <td>Optional</td> </tr> <tr> <td>time_filter</td> <td>A SQL expression that will be added to query where clause. Uses <a href="https://jinja.palletsprojects.com/">Jinja as template language</a>. Variables can be passed into the scan. See <a href="/soda-sql/documentation/time_partitioning.html">Time partitioning</a></td> <td>Optional</td> </tr> <tr> <td>mins_maxs_limit</td> <td>Max number of elements for the mins metric</td> <td>Optional, default is 5</td> </tr> <tr> <td>frequent_values_limit</td> <td>Max number of elements for the maxs metric</td> <td>Optional, default is 5</td> </tr> <tr> <td>sample_percentage</td> <td>Adds <a href="https://docs.snowflake.com/en/sql-reference/constructs/sample.html">sampling</a> to limit the number of rows scanned. Only tested on Postgres</td> <td>Optional</td> </tr> <tr> <td>sample_method</td> <td>For Snowflake, One of { BERNOULLI, ROW, SYSTEM, BLOCK }</td> <td>Required if sample_percentage is specified</td> </tr> </tbody> </table></div> <h2 id="metrics"> <a href="#metrics" class="anchor-heading" aria-labelledby="metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metrics </h2> <h3 id="table-metrics"> <a href="#table-metrics" class="anchor-heading" aria-labelledby="table-metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table metrics </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Meric</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>row_count</td> <td> </td> </tr> <tr> <td>schema</td> <td> </td> </tr> </tbody> </table></div> <h3 id="column-metrics"> <a href="#column-metrics" class="anchor-heading" aria-labelledby="column-metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Column metrics </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Meric</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>missing_count</td> <td> </td> </tr> <tr> <td>missing_percentage</td> <td> </td> </tr> <tr> <td>values_count</td> <td> </td> </tr> <tr> <td>values_percentage</td> <td> </td> </tr> <tr> <td>valid_count</td> <td> </td> </tr> <tr> <td>valid_percentage</td> <td> </td> </tr> <tr> <td>invalid_count</td> <td> </td> </tr> <tr> <td>invalid_percentage</td> <td> </td> </tr> <tr> <td>min</td> <td> </td> </tr> <tr> <td>max</td> <td> </td> </tr> <tr> <td>avg</td> <td> </td> </tr> <tr> <td>sum</td> <td> </td> </tr> <tr> <td>variance</td> <td> </td> </tr> <tr> <td>stddev</td> <td> </td> </tr> <tr> <td>min_length</td> <td> </td> </tr> <tr> <td>max_length</td> <td> </td> </tr> <tr> <td>avg_length</td> <td> </td> </tr> <tr> <td>distinct</td> <td> </td> </tr> <tr> <td>unique_count</td> <td> </td> </tr> <tr> <td>duplicate_count</td> <td> </td> </tr> <tr> <td>uniqueness</td> <td> </td> </tr> <tr> <td>maxs</td> <td> </td> </tr> <tr> <td>mins</td> <td> </td> </tr> <tr> <td>frequent_values</td> <td> </td> </tr> <tr> <td>histogram</td> <td> </td> </tr> </tbody> </table></div> <h3 id="metric-categories"> <a href="#metric-categories" class="anchor-heading" aria-labelledby="metric-categories"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Metric categories </h3> <blockquote> <p>Deprecated metric categories are now included in the metrics, but that is probably not a good idea. We’re considering to introduce <code class="language-plaintext highlighter-rouge">metric_categories</code> as a separate top level element</p> </blockquote> <div class="table-wrapper"><table> <thead> <tr> <th>Meric category</th> <th>Metrics</th> </tr> </thead> <tbody> <tr> <td>missing</td> <td>missing_count<br />missing_percentage<br />values_count<br />values_percentage</td> </tr> <tr> <td>validity</td> <td>valid_count<br />valid_percentage<br />invalid_count<br />invalid_percentage</td> </tr> <tr> <td>duplicates</td> <td>distinct<br />unique_count<br />uniqueness<br />duplicate_count</td> </tr> </tbody> </table></div> <h3 id="implied-metrics"> <a href="#implied-metrics" class="anchor-heading" aria-labelledby="implied-metrics"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Implied metrics </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Any metric in</th> <th>Implies metrics</th> </tr> </thead> <tbody> <tr> <td>valid_count<br />valid_percentage<br />invalid_count<br />invalid_percentage</td> <td>missing_count<br />missing_percentage<br />values_count<br />values_percentage</td> </tr> <tr> <td>missing_count<br />missing_percentage<br />values_count<br />values_percentage</td> <td>row_count</td> </tr> <tr> <td>histogram</td> <td>min<br />max</td> </tr> </tbody> </table></div> <h2 id="column-configurations"> <a href="#column-configurations" class="anchor-heading" aria-labelledby="column-configurations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Column configurations </h2> <p>Column configuration keys:</p> <div class="table-wrapper"><table> <thead> <tr> <th>Key</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>metrics</td> <td>Extra metrics to be computed for this column</td> </tr> <tr> <td>tests</td> <td>Tests to be evaluate for this column</td> </tr> <tr> <td>missing_values</td> <td>Customize what values are considered missing</td> </tr> <tr> <td>missing_format</td> <td>To customize missing values such as whitespace and empty strings</td> </tr> <tr> <td>missing_regex</td> <td>Define your own custom missing values</td> </tr> <tr> <td>valid_format</td> <td>Specifies valid values with a named valid text format</td> </tr> <tr> <td>valid_regex</td> <td>Specifies valid values with a regex</td> </tr> <tr> <td>valid_values</td> <td>Specifies valid values with a list of values</td> </tr> <tr> <td>valid_min</td> <td>Specifies a min value for valid values</td> </tr> <tr> <td>valid_max</td> <td>Specifies a max value for valid values</td> </tr> <tr> <td>valid_min_length</td> <td>Specifies a min length for valid values</td> </tr> <tr> <td>valid_max_length</td> <td>Specifies a max length for valid values</td> </tr> </tbody> </table></div> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
